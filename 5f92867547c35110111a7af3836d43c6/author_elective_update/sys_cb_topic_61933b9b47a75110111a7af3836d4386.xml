<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_topic">
    <sys_cb_topic action="DELETE">
        <applicability/>
        <applicability_mode>query</applicability_mode>
        <autopilot_topic>false</autopilot_topic>
        <category>3efd22da0b214300a1b16d2367673b32</category>
        <channels/>
        <connect_queue/>
        <description>ITSM conversation flow to check status of incidents and requested items.</description>
        <expose_on_palette>false</expose_on_palette>
        <flexible_conversation_switching>false</flexible_conversation_switching>
        <graph>{"graph_api_version":"1.0.41","variables":{"ac9244f2f6294112a5735e503f547b75":{"id":"ac9244f2f6294112a5735e503f547b75","name":"get_record","label":"Get Record","varType":"reference","table":"sc_req_item","category":"vaInputs"},"8323f5af1a014a388ea949d99d52ab04":{"id":"8323f5af1a014a388ea949d99d52ab04","name":"incident_or_requested_item","label":"Incident Or Requested Item","varType":"choice","choices":[{"label":"Incident","value":"incident"},{"label":"Requested Item ","value":"sc_req_item"}],"category":"vaInputs"},"cf9197df58da46c5bd4e924d6e01b5ff":{"id":"cf9197df58da46c5bd4e924d6e01b5ff","name":"add_comment","label":"Add Comment","varType":"boolean","category":"vaInputs"},"76eb6558382e45be84671e7ad20a5f42":{"id":"76eb6558382e45be84671e7ad20a5f42","name":"comment","label":"Comment","varType":"string","category":"vaInputs","secure":false,"encryptionSalt":{"value":"MTYyMzA1Mjg5ODU0NiBWQSBEZXNpZ25lciBpcyBhd2Vzb21l","mode":"simple"},"encryptionHashFunction":"SHA-256"},"1e872c8a927b4ce389f91f32de16fd43":{"id":"1e872c8a927b4ce389f91f32de16fd43","value":{"mode":"simple","value":"0"},"name":"index","label":"index","varType":"script","category":"vaVars"},"58bd025a9a304eed9c507fcd178c637c":{"id":"58bd025a9a304eed9c507fcd178c637c","value":{"mode":"simple","value":"5"},"name":"limit","label":"limit","varType":"script","category":"vaVars"},"08e2b78e1b6a4902ac0d3246c4c9a554":{"id":"08e2b78e1b6a4902ac0d3246c4c9a554","value":{"mode":"simple","value":"0"},"name":"incident_count","label":"incident_count","varType":"script","category":"vaVars"},"f5b973571c7d46c7a937867921018f21":{"id":"f5b973571c7d46c7a937867921018f21","value":{"mode":"simple","value":"0"},"name":"requested_item_count","label":"requested_item_count","varType":"script","category":"vaVars"},"6f90ef474bc3406e8cfcd95d22d02b28":{"id":"6f90ef474bc3406e8cfcd95d22d02b28","value":{"mode":"script","value":"(function execute() {\n    return gs.getProperty('sn_itsm_va.com.snc.itsm.virtualagent.portal_url', 'sp');\n})()\n"},"name":"service_portal_base_url","label":"service_portal_base_url","varType":"script","category":"vaVars"},"6764242be774471ea549ac68b024716c":{"id":"6764242be774471ea549ac68b024716c","value":{"mode":"script","value":"(function execute() {\n    return gs.getProperty('glide.servlet.uri') + '/';\n})()\n"},"name":"base_url","label":"base_url","varType":"script","category":"vaVars"},"74ac85b503764eed8ab6b0dfde141be7":{"id":"74ac85b503764eed8ab6b0dfde141be7","name":"LiveAgent_application","value":{"mode":"simple","value":"itsm"},"varType":"script","label":"LiveAgent_application","category":"vaVars"},"f27bff1adada4225b83129ea31818c5d":{"id":"f27bff1adada4225b83129ea31818c5d","value":{"value":"","mode":"simple"},"name":"table_name","label":"table_name","varType":"script","category":"vaVars"},"86e309bd1a7d4ebdb794e0b923473bff":{"id":"86e309bd1a7d4ebdb794e0b923473bff","value":{"mode":"simple","value":"0"},"name":"count","label":"count","varType":"script","category":"vaVars"},"14d39d48ca894ba09cbf9ad498a704e2":{"id":"14d39d48ca894ba09cbf9ad498a704e2","value":{"value":"","mode":"simple"},"name":"sys_id","label":"sys_id","varType":"script","category":"vaVars"},"9b2920bf9fd547b28f97c104272f2167":{"category":"vaInputs","id":"9b2920bf9fd547b28f97c104272f2167","label":"User","name":"user","table":"sys_user","varType":"reference"}},"goals":{"primary":{"id":"primary","trigger":{"type":"primary"},"name":"primary","applicability":"","description":"","nodes":{"b4c3e7af082f42699ab2802eff94a9df":{"id":"b4c3e7af082f42699ab2802eff94a9df","stepType":"Start","name":"Start","greetingResponse":{"mode":"simple","value":""},"applicability":{"mode":"query","value":""}},"707513038684487688131a8505655757":{"id":"707513038684487688131a8505655757","stepType":"TerminateGoal","name":"End","confirmationMessage":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""}},"aac82e3561e4485087d5410b599ebc2b":{"id":"aac82e3561e4485087d5410b599ebc2b","name":"Check Incidents and Requested Items","script":"(function execute() {\n    /*\n        Determining whether there are,\n        1. Active incidents opened by the current user\n        2. Active Requested items requested for the current user\n        and assigning the corresponding script variables.\n    */\n\n    // Setting the incident count\n    var incidents = new GlideAggregate('incident');\n    incidents.addQuery('active', true);\n    incidents.addQuery('caller_id', vaInputs.user);\n    incidents.addAggregate('COUNT');\n    incidents.query();\n    var incidentCount = 0;\n    if (incidents.next())\n        incidentCount = incidents.getAggregate('COUNT');\n        \n    vaVars.incident_count = incidentCount;\n\n    // Setting the requested items count\n    var reqItems = new GlideAggregate('sc_req_item');\n    reqItems.addQuery('active', true);\n    reqItems.addQuery('request.requested_for', vaInputs.user);\n    reqItems.addAggregate('COUNT');\n    reqItems.query();\n    var reqItemsCount = 0;\n    if (reqItems.next())\n        reqItemsCount = reqItems.getAggregate('COUNT');\n\n    vaVars.requested_item_count = reqItemsCount;\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"817212db90a244b1b7cc900330c58e0a":{"id":"817212db90a244b1b7cc900330c58e0a","stepType":"Decision","name":"Records  Decision","applicability":{"mode":"query","value":""}},"263e570380e64662b5c3ed0d7c483f63":{"stepType":"ReferenceChoicePrompt","name":"Get Record","prompt":{"value":"(function execute() {\n    if (vaVars.table_name == 'incident') {\n        if (parseInt(vaVars.incident_count) &gt; parseInt(vaVars.limit)) \n            return gs.getMessage('You have {0} incidents:', vaVars.incident_count);\n        else\n            return gs.getMessage('Here are your incidents:');\n    }\n\n    if (parseInt(vaVars.requested_item_count) &gt; parseInt(vaVars.limit)) \n        return gs.getMessage('You have {0} requested items:', vaVars.requested_item_count);\n    return gs.getMessage('Here are your requested items:');\n})()\n","mode":"script"},"confirmMessage":{"value":"","mode":"simple"},"acknowledgeMsg":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""},"optional":false,"defaultValue":{"value":"","mode":"simple"},"variableId":"ac9244f2f6294112a5735e503f547b75","id":"263e570380e64662b5c3ed0d7c483f63","mode":"external","script":"(function execute() {\n    /*\n        1. Query the requested items table and get all the active items requested_for the user\n        2. Show the recently updated 5(limit) requested items, apply pagination if there are more than 5.\n    */\n\n    var count = 0;\n    var options = [];    \n    var gr = new GlideRecord(vaVars.table_name);\n    gr.addActiveQuery();\n    if (vaVars.table_name == 'incident')\n        gr.addQuery('caller_id', vaInputs.user);\n    else \n        gr.addQuery('request.requested_for', vaInputs.user);\n\n    gr.orderByDesc('sys_updated_on');\n    gr.query();\n\n    count = gr.getRowCount();\n    vaVars.count = count;\n    var cnt = 0;\n\n    while(gr.next()) {\n        if (gr.canRead()) {\n            if (vaVars.table_name == 'incident')\n                options.push({ 'value': gr.getUniqueValue(), 'label': gr.getDisplayValue('short_description') + ' [' + gr.getValue('number') + ']'});\n            else\n                options.push({ 'value': gr.getUniqueValue(), 'label': gr.getDisplayValue('cat_item')  + ' [' + gr.getValue('number') + ']'});\n            cnt++;\n        } \n    }\n        \n    return options;\n})()","noRecordsResponseMsg":{"mode":"simple","value":[{"type":"paragraph","children":[{"text":""},{"text":"No Records Found"},{"text":""}]}]},"condition":{"value":"(function execute() {\n    /*\n        1. Query the requested items table and get all the active items requested_for the user\n        2. Show the recently updated 5(limit) requested items, apply pagination if there are more than 5.\n    */\n\n    var count = 0;\n    var options = [];    \n    var gr = new GlideRecord(vaVars.table_name);\n    gr.addActiveQuery();\n    if (vaVars.table_name == 'incident')\n        gr.addQuery('caller_id', vaInputs.user);\n    else \n        gr.addQuery('request.requested_for', vaInputs.user);\n\n    gr.orderByDesc('sys_updated_on');\n    gr.query();\n\n    count = gr.getRowCount();\n    vaVars.count = count;\n    var cnt = 0;\n\n    while(gr.next()) {\n        if (gr.canRead()) {\n            if (vaVars.table_name == 'incident')\n                options.push({ 'value': gr.getUniqueValue(), 'label': gr.getDisplayValue('short_description') + ' [' + gr.getValue('number') + ']'});\n            else\n                options.push({ 'value': gr.getUniqueValue(), 'label': gr.getDisplayValue('cat_item')  + ' [' + gr.getValue('number') + ']'});\n            cnt++;\n        } \n    }\n        \n    return options;\n})()","mode":"external_script"},"table":"sc_req_item","withNluUserInput":false,"skipIfFulfilled":true,"entity":{"id":"ticketnumber"},"skippable":{"value":"","mode":"query"},"cardMetadata":{"mode":"card","metadataScript":"","cardTemplate":"","cardFields":{},"cardDefinition":{}},"hasCardHeader":false},"9459d5cd8e2440e29c4ab8b84ffb0e60":{"stepType":"ChoicePrompt","name":"Incident or Requested Item","prompt":{"value":"(function execute() {\n    var output = '';\n    var incidents = '';\n    var items = '';\n\n    if (vaVars.incident_count != 1) {\n            incidents = gs.getMessage('{0} open incidents',vaVars.incident_count);\n    } else {\n            incidents = gs.getMessage('{0} open incident', vaVars.incident_count);\n    }\n\n    if (vaVars.requested_item_count != 1) {\n            items = gs.getMessage('{0} requested items', vaVars.requested_item_count);\n    } else {\n            items = gs.getMessage('{0} requested item', vaVars.requested_item_count);\n    }\n\n    return gs.getMessage('I just checked and you have {0} and {1}.  Which status would you like to check?', [incidents,items]);\n})()\n","mode":"script"},"confirmMessage":{"value":"","mode":"simple"},"acknowledgeMsg":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""},"optional":false,"defaultValue":{"value":"","mode":"simple"},"variableId":"8323f5af1a014a388ea949d99d52ab04","id":"9459d5cd8e2440e29c4ab8b84ffb0e60","withNluUserInput":false,"skipIfFulfilled":true,"entity":{"id":"tasktype"},"skippable":{"value":"","mode":"query"},"cardMetadata":{"mode":"card","metadataScript":"","cardTemplate":"","cardFields":{},"cardDefinition":{}},"hasCardHeader":false},"ce7baa0d48cf4e0ea3fc18d23006bb80":{"id":"ce7baa0d48cf4e0ea3fc18d23006bb80","stepType":"TextOutput","name":"No Incidents or Requested Items","value":[{"value":[{"type":"paragraph","children":[{"text":""},{"text":"You have no active incidents or requested items."},{"text":""}]}],"mode":"simple"}],"applicability":{"mode":"query","value":""},"secure":false},"d6ff90db9b8147068793cfd0687cde0b":{"id":"d6ff90db9b8147068793cfd0687cde0b","stepType":"Prompt","name":"Add Comment","prompt":{"value":[{"type":"paragraph","children":[{"text":""},{"text":"Would you like to add a comment?"},{"text":""}]}],"mode":"simple"},"confirmMessage":{"value":"","mode":"simple"},"acknowledgeMsg":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""},"optional":false,"defaultValue":{"value":"","mode":"simple"},"variableId":"cf9197df58da46c5bd4e924d6e01b5ff","withNluUserInput":false,"skipIfFulfilled":false,"entity":{"id":""},"skippable":{"value":"","mode":"query"},"inputType":{"format":"Text","script":""}},"4ed768f36f0942059d2e2763a5f9dbbf":{"id":"4ed768f36f0942059d2e2763a5f9dbbf","stepType":"Decision","name":"Add Comment Decision","applicability":{"mode":"query","value":""}},"4369c2eb869e44d08641d102151fefd4":{"id":"4369c2eb869e44d08641d102151fefd4","stepType":"Prompt","name":"Comment","prompt":{"value":[{"type":"paragraph","children":[{"text":""},{"text":"Please enter your comment."},{"text":""}]}],"mode":"simple"},"confirmMessage":{"value":"","mode":"simple"},"acknowledgeMsg":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""},"optional":false,"defaultValue":{"value":"","mode":"simple"},"variableId":"76eb6558382e45be84671e7ad20a5f42","withNluUserInput":false,"skipIfFulfilled":false,"entity":{"id":""},"skippable":{"value":"","mode":"query"},"inputType":{"format":"Text","script":""}},"1db7feee1ffb4d588f956798a6cc7a9f":{"id":"1db7feee1ffb4d588f956798a6cc7a9f","stepType":"ScriptOutput","name":"Update Record","output_type":"single_part","script":"(function execute() {\n    var response = '';\n    var gr = new GlideRecordSecure(vaVars.table_name);\n    if (gr.get(vaVars.sys_id)) {\n        var comment = vaInputs.comment.getValue().trim();\n        if (comment) {\n            gr.comments = comment;\n            gr.update();\n            if (vaVars.table_name == 'incident')\n                response = gs.getMessage(\"I've updated the incident.\");\n            else\n                response = gs.getMessage(\"I've updated the requested item.\");  \n        } else {\n            response = gs.getMessage(\"OK, no comment will be added.\");\n        }\n    } else\n        response = gs.getMessage(\"I couldn't find the record.\");\n\n    return response;\n})()","applicability":{"mode":"query","value":""}},"a394f1ecd485490db10ec6ba2ae515af":{"id":"a394f1ecd485490db10ec6ba2ae515af","stepType":"Decision","name":"Decision","applicability":{"mode":"query","value":""}},"2f2ffabfd25d40f08698f225a4337c0f":{"id":"2f2ffabfd25d40f08698f225a4337c0f","name":"Set Incident Table","script":"(function execute() {\n    vaVars.table_name = 'incident';\n    vaVars.count = vaVars.incident_count;\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"5fb9a8a0afe24ce68ec0fd254845c2a9":{"id":"5fb9a8a0afe24ce68ec0fd254845c2a9","name":"Set Requested Item table","script":"(function execute() {\n    vaVars.table_name = 'sc_req_item';\n    vaVars.count = vaVars.requested_item_count;\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"e1ca978b6e1b4dacb0083f436a5d47e8":{"id":"e1ca978b6e1b4dacb0083f436a5d47e8","name":"Set Table","script":"(function execute() {\n    vaVars.table_name = vaInputs.incident_or_requested_item;\n    if (vaVars.table_name == 'incident')\n        vaVars.count = vaVars.incident_count;\n    else \n        vaVars.count = vaVars.requested_item_count;\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"f02ac08b11454d5aa4cd83b2a8a89942":{"id":"f02ac08b11454d5aa4cd83b2a8a89942","name":"Set Sys Id","script":"(function execute() {\n    vaVars.sys_id = vaInputs.get_record.getValue();\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"95159172fb6645f19cd0781841a81a5a":{"id":"95159172fb6645f19cd0781841a81a5a","stepType":"TextOutput","name":"Before Card","value":[{"value":"(function execute() {\n    if (vaVars.table_name == 'incident') {\n        if (parseInt(vaVars.count) == 1)\n            return gs.getMessage('OK, here is your incident:');\n        return gs.getMessage('Here is your incident:');\n    }\n    if (parseInt(vaVars.count) == 1)\n        return gs.getMessage('OK, here is your requested item:');\n    return gs.getMessage('Here is your requested item:');\n})()\n","mode":"script"}],"applicability":{"mode":"query","value":""},"secure":false},"e74957aff1aa4609a1b6d326e7cf1bb0":{"id":"e74957aff1aa4609a1b6d326e7cf1bb0","stepType":"Decision","name":"Decision"},"aab0632b44eb43dcb333d54c8ffb2e77":{"id":"aab0632b44eb43dcb333d54c8ffb2e77","stepType":"RecordOutput","name":"Incident card","variableId":"","mode":"script","tableName":"incident","fields":["short_description","state","assigned_to","sys_updated_on","comments"],"applicability":{"value":"","mode":"query"},"condition":{"mode":"glide_query","value":"sys_id={{vaVars.sys_id}}"},"cardTemplate":"General","cardFields":{},"cardDefinition":{}},"608f6e0ee53c4a9bac6e55d9065fc5c2":{"id":"608f6e0ee53c4a9bac6e55d9065fc5c2","stepType":"RecordOutput","name":"Requested Item card","variableId":"","mode":"script","tableName":"sc_req_item","fields":["cat_item","state","assigned_to","sys_updated_on","comments"],"applicability":{"value":"","mode":"query"},"condition":{"mode":"glide_query","value":"sys_id={{vaVars.sys_id}}"},"cardTemplate":"General","cardFields":{},"cardDefinition":{}},"29a30f6b38da402987302e623a67ac50":{"id":"29a30f6b38da402987302e623a67ac50","stepType":"Decision","name":"Decision"},"78c961da27a8448da094617f53112778":{"id":"78c961da27a8448da094617f53112778","name":"Set Sys Id","script":"(function execute() {\n    // Query the requested item table and get the only requested item\n    var gr = new GlideRecord(vaVars.table_name);\n    gr.addQuery('active', true);\n    if (vaVars.table_name == 'incident')\n        gr.addQuery('caller_id', vaInputs.user);\n    else\n        gr.addQuery('request.requested_for', vaInputs.user);\n\n    gr.setLimit(1);\n    gr.query();\n    if (gr.next()) {\n        vaVars.sys_id = gr.getUniqueValue();\n    }\n})()\n","stepType":"ScriptAction","applicability":{"value":"","mode":"query"}}},"edges":[{"id":"48557628ae154386a9d7bfc2fab9ad9d","edgeType":"Edge","source":"2f2ffabfd25d40f08698f225a4337c0f","target":"29a30f6b38da402987302e623a67ac50","sourcePort":"","targetPort":""},{"id":"c5f7999feb0141539b770b5829005ace","edgeType":"Edge","source":"263e570380e64662b5c3ed0d7c483f63","target":"f02ac08b11454d5aa4cd83b2a8a89942","sourcePort":"","targetPort":""},{"id":"7167375936d64ba98e0511ff80041906","edgeType":"Edge","source":"aab0632b44eb43dcb333d54c8ffb2e77","target":"d6ff90db9b8147068793cfd0687cde0b","sourcePort":"","targetPort":""},{"id":"811f52a869224131995da43ef065747e","edgeType":"Branch","source":"4ed768f36f0942059d2e2763a5f9dbbf","target":"707513038684487688131a8505655757","sourcePort":"","targetPort":"","expression":{"value":"add_comment=","mode":"query"},"label":"No"},{"id":"37884540a03741a5b444655e952b0f3f","edgeType":"Branch","source":"a394f1ecd485490db10ec6ba2ae515af","target":"817212db90a244b1b7cc900330c58e0a","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.incident_count) != 0 || parseInt(vaVars.requested_item_count) != 0;\n})()\n"},"label":"Has Records"},{"id":"e4978294698b4a2e91f40c60f3966573","edgeType":"Edge","source":"f02ac08b11454d5aa4cd83b2a8a89942","target":"95159172fb6645f19cd0781841a81a5a","sourcePort":"","targetPort":""},{"id":"4df5b22ead004e40a7326340b778067d","edgeType":"Edge","source":"e1ca978b6e1b4dacb0083f436a5d47e8","target":"29a30f6b38da402987302e623a67ac50","sourcePort":"","targetPort":""},{"id":"630ac4e996fe416c8b6f0cec8bbe81f1","edgeType":"Edge","source":"1db7feee1ffb4d588f956798a6cc7a9f","target":"707513038684487688131a8505655757","sourcePort":"","targetPort":""},{"id":"bf22179c524840f3945550e37c5f07ce","edgeType":"Edge","source":"b4c3e7af082f42699ab2802eff94a9df","target":"aac82e3561e4485087d5410b599ebc2b","sourcePort":"","targetPort":""},{"id":"7e95ad62e9814258ae10b913fb549312","edgeType":"Branch","source":"817212db90a244b1b7cc900330c58e0a","target":"9459d5cd8e2440e29c4ab8b84ffb0e60","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return vaVars.incident_count != 0 &amp;&amp; vaVars.requested_item_count != 0;\n})()"},"label":"Both Incidents and Requested Items"},{"id":"bb8c24d673f64dcebfec532a2a02383b","edgeType":"Edge","source":"ce7baa0d48cf4e0ea3fc18d23006bb80","target":"707513038684487688131a8505655757","sourcePort":"","targetPort":""},{"id":"204bf3b30f544d6daf6f21bd0832131b","edgeType":"Edge","source":"d6ff90db9b8147068793cfd0687cde0b","target":"4ed768f36f0942059d2e2763a5f9dbbf","sourcePort":"","targetPort":""},{"id":"d279d65146a1443793a41a85e3a52a26","edgeType":"Branch","source":"4ed768f36f0942059d2e2763a5f9dbbf","target":"4369c2eb869e44d08641d102151fefd4","sourcePort":"","targetPort":"","expression":{"value":"add_comment=true","mode":"query"},"label":"Yes"},{"id":"7de23ebcf768468ea9a078e27ab2a8ad","edgeType":"Edge","source":"4369c2eb869e44d08641d102151fefd4","target":"1db7feee1ffb4d588f956798a6cc7a9f","sourcePort":"","targetPort":""},{"id":"3cc014caad7a4bcf8db9b579808bd43b","edgeType":"Edge","source":"aac82e3561e4485087d5410b599ebc2b","target":"a394f1ecd485490db10ec6ba2ae515af","sourcePort":"","targetPort":""},{"id":"56fff7c46c764a8286cff335648d26b6","edgeType":"Branch","source":"a394f1ecd485490db10ec6ba2ae515af","target":"ce7baa0d48cf4e0ea3fc18d23006bb80","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.incident_count) == 0 &amp;&amp; parseInt(vaVars.requested_item_count) == 0;\n})()\n"},"label":"Neither Incidents nor Requested Items"},{"id":"ff4c874e83b649468c8e22cf55e2e1d6","edgeType":"Branch","source":"817212db90a244b1b7cc900330c58e0a","target":"2f2ffabfd25d40f08698f225a4337c0f","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.incident_count) &gt; 0 &amp;&amp; parseInt(vaVars.requested_item_count) == 0;\n})()"},"label":"Incidents only"},{"id":"55f97e8f955443cda18659e3fb2a50b6","edgeType":"Branch","source":"817212db90a244b1b7cc900330c58e0a","target":"5fb9a8a0afe24ce68ec0fd254845c2a9","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.requested_item_count) &gt; 0 &amp;&amp; parseInt(vaVars.incident_count) == 0;\n})()\n"},"label":"Requested Items Only"},{"id":"3484ca1d903e44f19eb5327e4b81face","edgeType":"Edge","source":"9459d5cd8e2440e29c4ab8b84ffb0e60","target":"e1ca978b6e1b4dacb0083f436a5d47e8","sourcePort":"","targetPort":""},{"id":"9cbc99c8a6724d02ab3ad76db05d3445","edgeType":"Edge","source":"95159172fb6645f19cd0781841a81a5a","target":"e74957aff1aa4609a1b6d326e7cf1bb0","sourcePort":"","targetPort":""},{"id":"ba84463979e24c948896df814f135ba2","edgeType":"Branch","source":"e74957aff1aa4609a1b6d326e7cf1bb0","target":"aab0632b44eb43dcb333d54c8ffb2e77","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return vaVars.table_name == 'incident';\n})()\n"},"label":"Incident"},{"id":"f7ebda55ab20401ab4bba901ab793448","edgeType":"Branch","source":"e74957aff1aa4609a1b6d326e7cf1bb0","target":"608f6e0ee53c4a9bac6e55d9065fc5c2","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return vaVars.table_name == 'sc_req_item';\n})()\n"},"label":"Requested Item"},{"id":"5a424c2f4ea040bfa86dc639ce25c389","edgeType":"Edge","source":"608f6e0ee53c4a9bac6e55d9065fc5c2","target":"d6ff90db9b8147068793cfd0687cde0b","sourcePort":"","targetPort":""},{"id":"9bd46d4e71474334932cf224ef7a2eb9","edgeType":"Edge","source":"5fb9a8a0afe24ce68ec0fd254845c2a9","target":"29a30f6b38da402987302e623a67ac50","sourcePort":"","targetPort":""},{"id":"b5538188acef4dddb3328f37d2527e13","edgeType":"Branch","source":"29a30f6b38da402987302e623a67ac50","target":"263e570380e64662b5c3ed0d7c483f63","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return vaVars.count &gt; 1;\n})()"},"label":"Multiple Records"},{"id":"f8ce6999b16c4ca6995c6586fdc47b7c","edgeType":"Branch","source":"29a30f6b38da402987302e623a67ac50","target":"78c961da27a8448da094617f53112778","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.count) == 1;\n})()"},"label":"Only One Record"},{"id":"5997177b020f4313af10638aaf25baf1","edgeType":"Edge","source":"78c961da27a8448da094617f53112778","target":"95159172fb6645f19cd0781841a81a5a","sourcePort":"","targetPort":""}]}}}</graph>
        <key_phrases>GVS_SPORT Check sport incidents,ticket status,latest,update,check,status,Request,Requested Item,Incident</key_phrases>
        <library>false</library>
        <live_agent>false</live_agent>
        <name>GVS_SPORT Check sport incidents</name>
        <nlu_intent/>
        <nlu_intent_label/>
        <nlu_model/>
        <nlu_model_label/>
        <nlu_provider/>
        <palette_label/>
        <roles>x_933239_gvs_sport.admin,x_933239_gvs_sport.user</roles>
        <secure_custom_input_control>false</secure_custom_input_control>
        <source_topic_id>a30312ee53130010c839ddeeff7b124d</source_topic_id>
        <sys_class_name>sys_cb_topic</sys_class_name>
        <sys_created_by>admin_gv_bboukhriss</sys_created_by>
        <sys_created_on>2022-12-09 11:38:29</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>61933b9b47a75110111a7af3836d4386</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>GVS_SPORT Check sport incidents</sys_name>
        <sys_package display_value="[GVS] Sport Challenge" source="x_933239_gvs_sport">5f92867547c35110111a7af3836d43c6</sys_package>
        <sys_policy/>
        <sys_scope display_value="[GVS] Sport Challenge">5f92867547c35110111a7af3836d43c6</sys_scope>
        <sys_update_name>sys_cb_topic_61933b9b47a75110111a7af3836d4386</sys_update_name>
        <sys_updated_by>admin_gv_bboukhriss</sys_updated_by>
        <sys_updated_on>2022-12-09 11:41:00</sys_updated_on>
        <triggerable_by_notification>false</triggerable_by_notification>
        <type>STANDARD</type>
        <variables/>
    </sys_cb_topic>
    <sys_variable_value action="DELETE" query="document_key=61933b9b47a75110111a7af3836d4386"/>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="[GVS] Sport Challenge">5f92867547c35110111a7af3836d43c6</application>
        <file_path/>
        <instance_id>731c5619dbaaf0100b9d21c405961971</instance_id>
        <instance_name>dev119581</instance_name>
        <name>sys_cb_topic_61933b9b47a75110111a7af3836d4386</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_topic"><sys_cb_topic action="INSERT_OR_UPDATE"><applicability/><applicability_mode>query</applicability_mode><autopilot_topic>false</autopilot_topic><category>3efd22da0b214300a1b16d2367673b32</category><channels/><connect_queue/><description>ITSM conversation flow to check status of incidents and requested items.</description><expose_on_palette>false</expose_on_palette><flexible_conversation_switching>false</flexible_conversation_switching><graph>{"graph_api_version":"1.0.41","variables":{"ac9244f2f6294112a5735e503f547b75":{"id":"ac9244f2f6294112a5735e503f547b75","name":"get_record","label":"Get Record","varType":"reference","table":"sc_req_item","category":"vaInputs"},"8323f5af1a014a388ea949d99d52ab04":{"id":"8323f5af1a014a388ea949d99d52ab04","name":"incident_or_requested_item","label":"Incident Or Requested Item","varType":"choice","choices":[{"label":"Incident","value":"incident"},{"label":"Requested Item ","value":"sc_req_item"}],"category":"vaInputs"},"cf9197df58da46c5bd4e924d6e01b5ff":{"id":"cf9197df58da46c5bd4e924d6e01b5ff","name":"add_comment","label":"Add Comment","varType":"boolean","category":"vaInputs"},"76eb6558382e45be84671e7ad20a5f42":{"id":"76eb6558382e45be84671e7ad20a5f42","name":"comment","label":"Comment","varType":"string","category":"vaInputs","secure":false,"encryptionSalt":{"value":"MTYyMzA1Mjg5ODU0NiBWQSBEZXNpZ25lciBpcyBhd2Vzb21l","mode":"simple"},"encryptionHashFunction":"SHA-256"},"1e872c8a927b4ce389f91f32de16fd43":{"id":"1e872c8a927b4ce389f91f32de16fd43","value":{"mode":"simple","value":"0"},"name":"index","label":"index","varType":"script","category":"vaVars"},"58bd025a9a304eed9c507fcd178c637c":{"id":"58bd025a9a304eed9c507fcd178c637c","value":{"mode":"simple","value":"5"},"name":"limit","label":"limit","varType":"script","category":"vaVars"},"08e2b78e1b6a4902ac0d3246c4c9a554":{"id":"08e2b78e1b6a4902ac0d3246c4c9a554","value":{"mode":"simple","value":"0"},"name":"incident_count","label":"incident_count","varType":"script","category":"vaVars"},"f5b973571c7d46c7a937867921018f21":{"id":"f5b973571c7d46c7a937867921018f21","value":{"mode":"simple","value":"0"},"name":"requested_item_count","label":"requested_item_count","varType":"script","category":"vaVars"},"6f90ef474bc3406e8cfcd95d22d02b28":{"id":"6f90ef474bc3406e8cfcd95d22d02b28","value":{"mode":"script","value":"(function execute() {\n    return gs.getProperty('sn_itsm_va.com.snc.itsm.virtualagent.portal_url', 'sp');\n})()\n"},"name":"service_portal_base_url","label":"service_portal_base_url","varType":"script","category":"vaVars"},"6764242be774471ea549ac68b024716c":{"id":"6764242be774471ea549ac68b024716c","value":{"mode":"script","value":"(function execute() {\n    return gs.getProperty('glide.servlet.uri') + '/';\n})()\n"},"name":"base_url","label":"base_url","varType":"script","category":"vaVars"},"74ac85b503764eed8ab6b0dfde141be7":{"id":"74ac85b503764eed8ab6b0dfde141be7","name":"LiveAgent_application","value":{"mode":"simple","value":"itsm"},"varType":"script","label":"LiveAgent_application","category":"vaVars"},"f27bff1adada4225b83129ea31818c5d":{"id":"f27bff1adada4225b83129ea31818c5d","value":{"value":"","mode":"simple"},"name":"table_name","label":"table_name","varType":"script","category":"vaVars"},"86e309bd1a7d4ebdb794e0b923473bff":{"id":"86e309bd1a7d4ebdb794e0b923473bff","value":{"mode":"simple","value":"0"},"name":"count","label":"count","varType":"script","category":"vaVars"},"14d39d48ca894ba09cbf9ad498a704e2":{"id":"14d39d48ca894ba09cbf9ad498a704e2","value":{"value":"","mode":"simple"},"name":"sys_id","label":"sys_id","varType":"script","category":"vaVars"},"9b2920bf9fd547b28f97c104272f2167":{"category":"vaInputs","id":"9b2920bf9fd547b28f97c104272f2167","label":"User","name":"user","table":"sys_user","varType":"reference"}},"goals":{"primary":{"id":"primary","trigger":{"type":"primary"},"name":"primary","applicability":"","description":"","nodes":{"b4c3e7af082f42699ab2802eff94a9df":{"id":"b4c3e7af082f42699ab2802eff94a9df","stepType":"Start","name":"Start","greetingResponse":{"mode":"simple","value":""},"applicability":{"mode":"query","value":""}},"707513038684487688131a8505655757":{"id":"707513038684487688131a8505655757","stepType":"TerminateGoal","name":"End","confirmationMessage":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""}},"aac82e3561e4485087d5410b599ebc2b":{"id":"aac82e3561e4485087d5410b599ebc2b","name":"Check Incidents and Requested Items","script":"(function execute() {\n    /*\n        Determining whether there are,\n        1. Active incidents opened by the current user\n        2. Active Requested items requested for the current user\n        and assigning the corresponding script variables.\n    */\n\n    // Setting the incident count\n    var incidents = new GlideAggregate('incident');\n    incidents.addQuery('active', true);\n    incidents.addQuery('caller_id', vaInputs.user);\n    incidents.addAggregate('COUNT');\n    incidents.query();\n    var incidentCount = 0;\n    if (incidents.next())\n        incidentCount = incidents.getAggregate('COUNT');\n        \n    vaVars.incident_count = incidentCount;\n\n    // Setting the requested items count\n    var reqItems = new GlideAggregate('sc_req_item');\n    reqItems.addQuery('active', true);\n    reqItems.addQuery('request.requested_for', vaInputs.user);\n    reqItems.addAggregate('COUNT');\n    reqItems.query();\n    var reqItemsCount = 0;\n    if (reqItems.next())\n        reqItemsCount = reqItems.getAggregate('COUNT');\n\n    vaVars.requested_item_count = reqItemsCount;\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"817212db90a244b1b7cc900330c58e0a":{"id":"817212db90a244b1b7cc900330c58e0a","stepType":"Decision","name":"Records  Decision","applicability":{"mode":"query","value":""}},"263e570380e64662b5c3ed0d7c483f63":{"stepType":"ReferenceChoicePrompt","name":"Get Record","prompt":{"value":"(function execute() {\n    if (vaVars.table_name == 'incident') {\n        if (parseInt(vaVars.incident_count) &gt; parseInt(vaVars.limit)) \n            return gs.getMessage('You have {0} incidents:', vaVars.incident_count);\n        else\n            return gs.getMessage('Here are your incidents:');\n    }\n\n    if (parseInt(vaVars.requested_item_count) &gt; parseInt(vaVars.limit)) \n        return gs.getMessage('You have {0} requested items:', vaVars.requested_item_count);\n    return gs.getMessage('Here are your requested items:');\n})()\n","mode":"script"},"confirmMessage":{"value":"","mode":"simple"},"acknowledgeMsg":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""},"optional":false,"defaultValue":{"value":"","mode":"simple"},"variableId":"ac9244f2f6294112a5735e503f547b75","id":"263e570380e64662b5c3ed0d7c483f63","mode":"external","script":"(function execute() {\n    /*\n        1. Query the requested items table and get all the active items requested_for the user\n        2. Show the recently updated 5(limit) requested items, apply pagination if there are more than 5.\n    */\n\n    var count = 0;\n    var options = [];    \n    var gr = new GlideRecord(vaVars.table_name);\n    gr.addActiveQuery();\n    if (vaVars.table_name == 'incident')\n        gr.addQuery('caller_id', vaInputs.user);\n    else \n        gr.addQuery('request.requested_for', vaInputs.user);\n\n    gr.orderByDesc('sys_updated_on');\n    gr.query();\n\n    count = gr.getRowCount();\n    vaVars.count = count;\n    var cnt = 0;\n\n    while(gr.next()) {\n        if (gr.canRead()) {\n            if (vaVars.table_name == 'incident')\n                options.push({ 'value': gr.getUniqueValue(), 'label': gr.getDisplayValue('short_description') + ' [' + gr.getValue('number') + ']'});\n            else\n                options.push({ 'value': gr.getUniqueValue(), 'label': gr.getDisplayValue('cat_item')  + ' [' + gr.getValue('number') + ']'});\n            cnt++;\n        } \n    }\n        \n    return options;\n})()","noRecordsResponseMsg":{"mode":"simple","value":[{"type":"paragraph","children":[{"text":""},{"text":"No Records Found"},{"text":""}]}]},"condition":{"value":"(function execute() {\n    /*\n        1. Query the requested items table and get all the active items requested_for the user\n        2. Show the recently updated 5(limit) requested items, apply pagination if there are more than 5.\n    */\n\n    var count = 0;\n    var options = [];    \n    var gr = new GlideRecord(vaVars.table_name);\n    gr.addActiveQuery();\n    if (vaVars.table_name == 'incident')\n        gr.addQuery('caller_id', vaInputs.user);\n    else \n        gr.addQuery('request.requested_for', vaInputs.user);\n\n    gr.orderByDesc('sys_updated_on');\n    gr.query();\n\n    count = gr.getRowCount();\n    vaVars.count = count;\n    var cnt = 0;\n\n    while(gr.next()) {\n        if (gr.canRead()) {\n            if (vaVars.table_name == 'incident')\n                options.push({ 'value': gr.getUniqueValue(), 'label': gr.getDisplayValue('short_description') + ' [' + gr.getValue('number') + ']'});\n            else\n                options.push({ 'value': gr.getUniqueValue(), 'label': gr.getDisplayValue('cat_item')  + ' [' + gr.getValue('number') + ']'});\n            cnt++;\n        } \n    }\n        \n    return options;\n})()","mode":"external_script"},"table":"sc_req_item","withNluUserInput":false,"skipIfFulfilled":true,"entity":{"id":"ticketnumber"},"skippable":{"value":"","mode":"query"},"cardMetadata":{"mode":"card","metadataScript":"","cardTemplate":"","cardFields":{},"cardDefinition":{}},"hasCardHeader":false},"9459d5cd8e2440e29c4ab8b84ffb0e60":{"stepType":"ChoicePrompt","name":"Incident or Requested Item","prompt":{"value":"(function execute() {\n    var output = '';\n    var incidents = '';\n    var items = '';\n\n    if (vaVars.incident_count != 1) {\n            incidents = gs.getMessage('{0} open incidents',vaVars.incident_count);\n    } else {\n            incidents = gs.getMessage('{0} open incident', vaVars.incident_count);\n    }\n\n    if (vaVars.requested_item_count != 1) {\n            items = gs.getMessage('{0} requested items', vaVars.requested_item_count);\n    } else {\n            items = gs.getMessage('{0} requested item', vaVars.requested_item_count);\n    }\n\n    return gs.getMessage('I just checked and you have {0} and {1}.  Which status would you like to check?', [incidents,items]);\n})()\n","mode":"script"},"confirmMessage":{"value":"","mode":"simple"},"acknowledgeMsg":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""},"optional":false,"defaultValue":{"value":"","mode":"simple"},"variableId":"8323f5af1a014a388ea949d99d52ab04","id":"9459d5cd8e2440e29c4ab8b84ffb0e60","withNluUserInput":false,"skipIfFulfilled":true,"entity":{"id":"tasktype"},"skippable":{"value":"","mode":"query"},"cardMetadata":{"mode":"card","metadataScript":"","cardTemplate":"","cardFields":{},"cardDefinition":{}},"hasCardHeader":false},"ce7baa0d48cf4e0ea3fc18d23006bb80":{"id":"ce7baa0d48cf4e0ea3fc18d23006bb80","stepType":"TextOutput","name":"No Incidents or Requested Items","value":[{"value":[{"type":"paragraph","children":[{"text":""},{"text":"You have no active incidents or requested items."},{"text":""}]}],"mode":"simple"}],"applicability":{"mode":"query","value":""},"secure":false},"d6ff90db9b8147068793cfd0687cde0b":{"id":"d6ff90db9b8147068793cfd0687cde0b","stepType":"Prompt","name":"Add Comment","prompt":{"value":[{"type":"paragraph","children":[{"text":""},{"text":"Would you like to add a comment?"},{"text":""}]}],"mode":"simple"},"confirmMessage":{"value":"","mode":"simple"},"acknowledgeMsg":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""},"optional":false,"defaultValue":{"value":"","mode":"simple"},"variableId":"cf9197df58da46c5bd4e924d6e01b5ff","withNluUserInput":false,"skipIfFulfilled":false,"entity":{"id":""},"skippable":{"value":"","mode":"query"},"inputType":{"format":"Text","script":""}},"4ed768f36f0942059d2e2763a5f9dbbf":{"id":"4ed768f36f0942059d2e2763a5f9dbbf","stepType":"Decision","name":"Add Comment Decision","applicability":{"mode":"query","value":""}},"4369c2eb869e44d08641d102151fefd4":{"id":"4369c2eb869e44d08641d102151fefd4","stepType":"Prompt","name":"Comment","prompt":{"value":[{"type":"paragraph","children":[{"text":""},{"text":"Please enter your comment."},{"text":""}]}],"mode":"simple"},"confirmMessage":{"value":"","mode":"simple"},"acknowledgeMsg":{"value":"","mode":"simple"},"applicability":{"mode":"query","value":""},"optional":false,"defaultValue":{"value":"","mode":"simple"},"variableId":"76eb6558382e45be84671e7ad20a5f42","withNluUserInput":false,"skipIfFulfilled":false,"entity":{"id":""},"skippable":{"value":"","mode":"query"},"inputType":{"format":"Text","script":""}},"1db7feee1ffb4d588f956798a6cc7a9f":{"id":"1db7feee1ffb4d588f956798a6cc7a9f","stepType":"ScriptOutput","name":"Update Record","output_type":"single_part","script":"(function execute() {\n    var response = '';\n    var gr = new GlideRecordSecure(vaVars.table_name);\n    if (gr.get(vaVars.sys_id)) {\n        var comment = vaInputs.comment.getValue().trim();\n        if (comment) {\n            gr.comments = comment;\n            gr.update();\n            if (vaVars.table_name == 'incident')\n                response = gs.getMessage(\"I've updated the incident.\");\n            else\n                response = gs.getMessage(\"I've updated the requested item.\");  \n        } else {\n            response = gs.getMessage(\"OK, no comment will be added.\");\n        }\n    } else\n        response = gs.getMessage(\"I couldn't find the record.\");\n\n    return response;\n})()","applicability":{"mode":"query","value":""}},"a394f1ecd485490db10ec6ba2ae515af":{"id":"a394f1ecd485490db10ec6ba2ae515af","stepType":"Decision","name":"Decision","applicability":{"mode":"query","value":""}},"2f2ffabfd25d40f08698f225a4337c0f":{"id":"2f2ffabfd25d40f08698f225a4337c0f","name":"Set Incident Table","script":"(function execute() {\n    vaVars.table_name = 'incident';\n    vaVars.count = vaVars.incident_count;\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"5fb9a8a0afe24ce68ec0fd254845c2a9":{"id":"5fb9a8a0afe24ce68ec0fd254845c2a9","name":"Set Requested Item table","script":"(function execute() {\n    vaVars.table_name = 'sc_req_item';\n    vaVars.count = vaVars.requested_item_count;\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"e1ca978b6e1b4dacb0083f436a5d47e8":{"id":"e1ca978b6e1b4dacb0083f436a5d47e8","name":"Set Table","script":"(function execute() {\n    vaVars.table_name = vaInputs.incident_or_requested_item;\n    if (vaVars.table_name == 'incident')\n        vaVars.count = vaVars.incident_count;\n    else \n        vaVars.count = vaVars.requested_item_count;\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"f02ac08b11454d5aa4cd83b2a8a89942":{"id":"f02ac08b11454d5aa4cd83b2a8a89942","name":"Set Sys Id","script":"(function execute() {\n    vaVars.sys_id = vaInputs.get_record.getValue();\n})()\n","stepType":"ScriptAction","applicability":{"mode":"query","value":""}},"95159172fb6645f19cd0781841a81a5a":{"id":"95159172fb6645f19cd0781841a81a5a","stepType":"TextOutput","name":"Before Card","value":[{"value":"(function execute() {\n    if (vaVars.table_name == 'incident') {\n        if (parseInt(vaVars.count) == 1)\n            return gs.getMessage('OK, here is your incident:');\n        return gs.getMessage('Here is your incident:');\n    }\n    if (parseInt(vaVars.count) == 1)\n        return gs.getMessage('OK, here is your requested item:');\n    return gs.getMessage('Here is your requested item:');\n})()\n","mode":"script"}],"applicability":{"mode":"query","value":""},"secure":false},"e74957aff1aa4609a1b6d326e7cf1bb0":{"id":"e74957aff1aa4609a1b6d326e7cf1bb0","stepType":"Decision","name":"Decision"},"aab0632b44eb43dcb333d54c8ffb2e77":{"id":"aab0632b44eb43dcb333d54c8ffb2e77","stepType":"RecordOutput","name":"Incident card","variableId":"","mode":"script","tableName":"incident","fields":["short_description","state","assigned_to","sys_updated_on","comments"],"applicability":{"value":"","mode":"query"},"condition":{"mode":"glide_query","value":"sys_id={{vaVars.sys_id}}"},"cardTemplate":"General","cardFields":{},"cardDefinition":{}},"608f6e0ee53c4a9bac6e55d9065fc5c2":{"id":"608f6e0ee53c4a9bac6e55d9065fc5c2","stepType":"RecordOutput","name":"Requested Item card","variableId":"","mode":"script","tableName":"sc_req_item","fields":["cat_item","state","assigned_to","sys_updated_on","comments"],"applicability":{"value":"","mode":"query"},"condition":{"mode":"glide_query","value":"sys_id={{vaVars.sys_id}}"},"cardTemplate":"General","cardFields":{},"cardDefinition":{}},"29a30f6b38da402987302e623a67ac50":{"id":"29a30f6b38da402987302e623a67ac50","stepType":"Decision","name":"Decision"},"78c961da27a8448da094617f53112778":{"id":"78c961da27a8448da094617f53112778","name":"Set Sys Id","script":"(function execute() {\n    // Query the requested item table and get the only requested item\n    var gr = new GlideRecord(vaVars.table_name);\n    gr.addQuery('active', true);\n    if (vaVars.table_name == 'incident')\n        gr.addQuery('caller_id', vaInputs.user);\n    else\n        gr.addQuery('request.requested_for', vaInputs.user);\n\n    gr.setLimit(1);\n    gr.query();\n    if (gr.next()) {\n        vaVars.sys_id = gr.getUniqueValue();\n    }\n})()\n","stepType":"ScriptAction","applicability":{"value":"","mode":"query"}}},"edges":[{"id":"48557628ae154386a9d7bfc2fab9ad9d","edgeType":"Edge","source":"2f2ffabfd25d40f08698f225a4337c0f","target":"29a30f6b38da402987302e623a67ac50","sourcePort":"","targetPort":""},{"id":"c5f7999feb0141539b770b5829005ace","edgeType":"Edge","source":"263e570380e64662b5c3ed0d7c483f63","target":"f02ac08b11454d5aa4cd83b2a8a89942","sourcePort":"","targetPort":""},{"id":"7167375936d64ba98e0511ff80041906","edgeType":"Edge","source":"aab0632b44eb43dcb333d54c8ffb2e77","target":"d6ff90db9b8147068793cfd0687cde0b","sourcePort":"","targetPort":""},{"id":"811f52a869224131995da43ef065747e","edgeType":"Branch","source":"4ed768f36f0942059d2e2763a5f9dbbf","target":"707513038684487688131a8505655757","sourcePort":"","targetPort":"","expression":{"value":"add_comment=","mode":"query"},"label":"No"},{"id":"37884540a03741a5b444655e952b0f3f","edgeType":"Branch","source":"a394f1ecd485490db10ec6ba2ae515af","target":"817212db90a244b1b7cc900330c58e0a","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.incident_count) != 0 || parseInt(vaVars.requested_item_count) != 0;\n})()\n"},"label":"Has Records"},{"id":"e4978294698b4a2e91f40c60f3966573","edgeType":"Edge","source":"f02ac08b11454d5aa4cd83b2a8a89942","target":"95159172fb6645f19cd0781841a81a5a","sourcePort":"","targetPort":""},{"id":"4df5b22ead004e40a7326340b778067d","edgeType":"Edge","source":"e1ca978b6e1b4dacb0083f436a5d47e8","target":"29a30f6b38da402987302e623a67ac50","sourcePort":"","targetPort":""},{"id":"630ac4e996fe416c8b6f0cec8bbe81f1","edgeType":"Edge","source":"1db7feee1ffb4d588f956798a6cc7a9f","target":"707513038684487688131a8505655757","sourcePort":"","targetPort":""},{"id":"bf22179c524840f3945550e37c5f07ce","edgeType":"Edge","source":"b4c3e7af082f42699ab2802eff94a9df","target":"aac82e3561e4485087d5410b599ebc2b","sourcePort":"","targetPort":""},{"id":"7e95ad62e9814258ae10b913fb549312","edgeType":"Branch","source":"817212db90a244b1b7cc900330c58e0a","target":"9459d5cd8e2440e29c4ab8b84ffb0e60","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return vaVars.incident_count != 0 &amp;&amp; vaVars.requested_item_count != 0;\n})()"},"label":"Both Incidents and Requested Items"},{"id":"bb8c24d673f64dcebfec532a2a02383b","edgeType":"Edge","source":"ce7baa0d48cf4e0ea3fc18d23006bb80","target":"707513038684487688131a8505655757","sourcePort":"","targetPort":""},{"id":"204bf3b30f544d6daf6f21bd0832131b","edgeType":"Edge","source":"d6ff90db9b8147068793cfd0687cde0b","target":"4ed768f36f0942059d2e2763a5f9dbbf","sourcePort":"","targetPort":""},{"id":"d279d65146a1443793a41a85e3a52a26","edgeType":"Branch","source":"4ed768f36f0942059d2e2763a5f9dbbf","target":"4369c2eb869e44d08641d102151fefd4","sourcePort":"","targetPort":"","expression":{"value":"add_comment=true","mode":"query"},"label":"Yes"},{"id":"7de23ebcf768468ea9a078e27ab2a8ad","edgeType":"Edge","source":"4369c2eb869e44d08641d102151fefd4","target":"1db7feee1ffb4d588f956798a6cc7a9f","sourcePort":"","targetPort":""},{"id":"3cc014caad7a4bcf8db9b579808bd43b","edgeType":"Edge","source":"aac82e3561e4485087d5410b599ebc2b","target":"a394f1ecd485490db10ec6ba2ae515af","sourcePort":"","targetPort":""},{"id":"56fff7c46c764a8286cff335648d26b6","edgeType":"Branch","source":"a394f1ecd485490db10ec6ba2ae515af","target":"ce7baa0d48cf4e0ea3fc18d23006bb80","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.incident_count) == 0 &amp;&amp; parseInt(vaVars.requested_item_count) == 0;\n})()\n"},"label":"Neither Incidents nor Requested Items"},{"id":"ff4c874e83b649468c8e22cf55e2e1d6","edgeType":"Branch","source":"817212db90a244b1b7cc900330c58e0a","target":"2f2ffabfd25d40f08698f225a4337c0f","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.incident_count) &gt; 0 &amp;&amp; parseInt(vaVars.requested_item_count) == 0;\n})()"},"label":"Incidents only"},{"id":"55f97e8f955443cda18659e3fb2a50b6","edgeType":"Branch","source":"817212db90a244b1b7cc900330c58e0a","target":"5fb9a8a0afe24ce68ec0fd254845c2a9","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.requested_item_count) &gt; 0 &amp;&amp; parseInt(vaVars.incident_count) == 0;\n})()\n"},"label":"Requested Items Only"},{"id":"3484ca1d903e44f19eb5327e4b81face","edgeType":"Edge","source":"9459d5cd8e2440e29c4ab8b84ffb0e60","target":"e1ca978b6e1b4dacb0083f436a5d47e8","sourcePort":"","targetPort":""},{"id":"9cbc99c8a6724d02ab3ad76db05d3445","edgeType":"Edge","source":"95159172fb6645f19cd0781841a81a5a","target":"e74957aff1aa4609a1b6d326e7cf1bb0","sourcePort":"","targetPort":""},{"id":"ba84463979e24c948896df814f135ba2","edgeType":"Branch","source":"e74957aff1aa4609a1b6d326e7cf1bb0","target":"aab0632b44eb43dcb333d54c8ffb2e77","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return vaVars.table_name == 'incident';\n})()\n"},"label":"Incident"},{"id":"f7ebda55ab20401ab4bba901ab793448","edgeType":"Branch","source":"e74957aff1aa4609a1b6d326e7cf1bb0","target":"608f6e0ee53c4a9bac6e55d9065fc5c2","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return vaVars.table_name == 'sc_req_item';\n})()\n"},"label":"Requested Item"},{"id":"5a424c2f4ea040bfa86dc639ce25c389","edgeType":"Edge","source":"608f6e0ee53c4a9bac6e55d9065fc5c2","target":"d6ff90db9b8147068793cfd0687cde0b","sourcePort":"","targetPort":""},{"id":"9bd46d4e71474334932cf224ef7a2eb9","edgeType":"Edge","source":"5fb9a8a0afe24ce68ec0fd254845c2a9","target":"29a30f6b38da402987302e623a67ac50","sourcePort":"","targetPort":""},{"id":"b5538188acef4dddb3328f37d2527e13","edgeType":"Branch","source":"29a30f6b38da402987302e623a67ac50","target":"263e570380e64662b5c3ed0d7c483f63","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return vaVars.count &gt; 1;\n})()"},"label":"Multiple Records"},{"id":"f8ce6999b16c4ca6995c6586fdc47b7c","edgeType":"Branch","source":"29a30f6b38da402987302e623a67ac50","target":"78c961da27a8448da094617f53112778","sourcePort":"","targetPort":"","expression":{"mode":"script","value":"(function execute() {\n    return parseInt(vaVars.count) == 1;\n})()"},"label":"Only One Record"},{"id":"5997177b020f4313af10638aaf25baf1","edgeType":"Edge","source":"78c961da27a8448da094617f53112778","target":"95159172fb6645f19cd0781841a81a5a","sourcePort":"","targetPort":""}]}}}</graph><key_phrases>GVS_SPORT Check sport incidents,ticket status,latest,update,check,status,Request,Requested Item,Incident</key_phrases><library>false</library><live_agent>false</live_agent><name>GVS_SPORT Check sport incidents</name><nlu_intent/><nlu_intent_label/><nlu_model/><nlu_model_label/><nlu_provider/><palette_label/><roles>x_933239_gvs_sport.admin,x_933239_gvs_sport.user</roles><secure_custom_input_control>false</secure_custom_input_control><source_topic_id>a30312ee53130010c839ddeeff7b124d</source_topic_id><sys_class_name>sys_cb_topic</sys_class_name><sys_created_by>admin_gv_bboukhriss</sys_created_by><sys_created_on>2022-12-09 11:38:29</sys_created_on><sys_domain>global</sys_domain><sys_id>61933b9b47a75110111a7af3836d4386</sys_id><sys_mod_count>1</sys_mod_count><sys_name>GVS_SPORT Check sport incidents</sys_name><sys_package display_value="[GVS] Sport Challenge" source="x_933239_gvs_sport">5f92867547c35110111a7af3836d43c6</sys_package><sys_policy/><sys_scope display_value="[GVS] Sport Challenge">5f92867547c35110111a7af3836d43c6</sys_scope><sys_update_name>sys_cb_topic_61933b9b47a75110111a7af3836d4386</sys_update_name><sys_updated_by>admin_gv_bboukhriss</sys_updated_by><sys_updated_on>2022-12-09 11:41:00</sys_updated_on><triggerable_by_notification>false</triggerable_by_notification><type>STANDARD</type><variables/></sys_cb_topic><sys_variable_value action="delete_multiple" query="document_key=61933b9b47a75110111a7af3836d4386"/></record_update>]]></payload>
        <payload_hash>-1215557371</payload_hash>
        <record_name>GVS_SPORT Check sport incidents</record_name>
        <reverted_from/>
        <source>af3cf796470bd110111a7af3836d43a2</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>admin_gv_bboukhriss</sys_created_by>
        <sys_created_on>2022-12-09 11:41:00</sys_created_on>
        <sys_id>ae24bf5f47a75110111a7af3836d432d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>184f6b04fc30000001</sys_recorded_at>
        <sys_updated_by>admin_gv_bboukhriss</sys_updated_by>
        <sys_updated_on>2022-12-09 11:41:00</sys_updated_on>
        <type>Topic</type>
        <update_guid>e624bf5feca75110ffda51c0c870e82d</update_guid>
        <update_guid_history>e624bf5feca75110ffda51c0c870e82d:-1215557371,3993bf1ff3a7511056e4dcbba4e898ef:473160524</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete/>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>admin_gv_bboukhriss</sys_created_by>
        <sys_created_on>2022-12-16 03:59:22</sys_created_on>
        <sys_db_object display_value="" name="sys_cb_topic">sys_cb_topic</sys_db_object>
        <sys_id>761edb843f644a20b744848e17e88400</sys_id>
        <sys_metadata>61933b9b47a75110111a7af3836d4386</sys_metadata>
        <sys_name>GVS_SPORT Check sport incidents</sys_name>
        <sys_package display_value="[GVS] Sport Challenge" source="x_933239_gvs_sport">5f92867547c35110111a7af3836d43c6</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_scope display_value="[GVS] Sport Challenge">5f92867547c35110111a7af3836d43c6</sys_scope>
        <sys_scope_delete display_value="">11ca469d20c34249a742182289ebe249</sys_scope_delete>
        <sys_update_name>sys_cb_topic_61933b9b47a75110111a7af3836d4386</sys_update_name>
        <sys_update_version display_value="sys_cb_topic_61933b9b47a75110111a7af3836d4386">ae24bf5f47a75110111a7af3836d432d</sys_update_version>
    </sys_metadata_delete>
</record_update>
